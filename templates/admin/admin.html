<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Inscription</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
        }

        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .table th, .table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .table th {
            background-color: #f0f0f0;
        }

        .table input[type="text"], 
        .table input[type="date"], 
        .table input[type="number"], 
        .table textarea, 
        .table select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .table select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }
        .alert-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            width: 588px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
            border-radius: 8px;
        }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        .alert-error {
            color: #a94442;
            background-color: #f2dede;
            border-color: #ebccd1;
        }
        .alert-success {
            color: #3c763d;
            background-color: #dff0d8;
            border-color: #d6e9c6;
        }
        .close-btn {
            background-color: #ddd;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
    <script>
        function closeAlert() {
            document.querySelector('.alert-container').style.display = 'none';
        }
        function updateBureauOptions() {
            var service = document.getElementById('service').value;
            var bureauSelect = document.getElementById('bureau');
            var bureauOptions = {
                "Service ingénierie des compétences et gestion de la formation": [
                    { value: 'a1', text: 'a1' },
                    { value: 'a2', text: 'a2' },
                    { value: 'a3', text: 'a3' },
                    { value: 'a4', text: 'a4' },
                    { value: 'a5', text: 'a5' },
                    { value: 'a6', text: 'a6' },
                    { value: 'a7', text: 'a7' },
                    { value: 'a8', text: 'a8' },
                    { value: 'a9', text: 'a9' },
                ],
                "Service science d'écologie de biodiversité et d'érosion": [
                    { value: 'c1', text: 'c1' },
                    { value: 'c2', text: 'c2' },
                    { value: 'c3', text: 'c3' },
                    { value: 'c4', text: 'c4' },
                    { value: 'c5', text: 'c5' },
                    { value: 'c6', text: 'c6' },
                    { value: 'c7', text: 'c7' },
                    { value: 'c8', text: 'c8' },
                    { value: 'c9', text: 'c9' },
                ],
                "Service science d'amélioration génétiques des arbres forestiers et sylviculture": [
                    { value: 'd1', text: 'd1' },
                    { value: 'd2', text: 'd2' },
                    { value: 'd3', text: 'd3' },
                    { value: 'd4', text: 'd4' },
                    { value: 'd5', text: 'd5' },
                    { value: 'd6', text: 'd6' },
                    { value: 'd7', text: 'd7' },
                    { value: 'd8', text: 'd8' },
                    { value: 'd9', text: 'd9' },
                ],
                "Service technologie du bois et des produits forestiers": [
                    { value: 'e1', text: 'e1' },
                    { value: 'e2', text: 'e2' },
                    { value: 'e3', text: 'e3' },
                    { value: 'e4', text: 'e4' },
                    { value: 'e5', text: 'e5' },
                    { value: 'e6', text: 'e6' },
                    { value: 'e7', text: 'e7' },
                    { value: 'e8', text: 'e8' },
                    { value: 'e9', text: 'e9' },
                ],
            };

            // Supprime toutes les options existantes
            bureauSelect.innerHTML = '';

            // Ajoute les nouvelles options
            if (bureauOptions[service]) {
                bureauOptions[service].forEach(function(option) {
                    var newOption = document.createElement('option');
                    newOption.value = option.value;
                    newOption.text = option.text;
                    bureauSelect.appendChild(newOption);
                });
                bureauSelect.style.display = 'block';
            } else {
                bureauSelect.style.display = 'none';
            }
        }
    </script>
  </head>
<body>
  <header class="mb-8 flex items-center justify-between md:mb-16 md:py-0 border-b-2 border-gray-500 md:px-8" style="height: 90px;">
    <a href="/dashboard" >
      <img src="/static/images/b.jpg" style="width: 260px; height: 88px; margin-left: -50px;">
    </a>
       <nav class="hidden gap-12 lg:flex">
      <a href="/admin" class="text-lg font-semibold text-indigo-500">Inscription</a>
      <a href="/liste_employe" class="text-lg font-semibold text-gray-600 transition duration-100 hover:text-indigo-500 active:text-indigo-700">Liste des Employes</a>
      <a href="/liste_responsable"  class="text-lg font-semibold text-gray-600 transition duration-100 hover:text-indigo-500 active:text-indigo-700">Liste des Responsables</a>
    </nav>
     <div class="relative inline-block text-left">
         <div>
           <button
             type="button"
             onclick="toggleMenu()"
             class="text-lg font-semibold px-6 py-2 inline-flex w-full justify-center gap-x-1.5 rounded-md bg-white text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 flex items-center"
             id="menu-button"
             aria-expanded="false"
             aria-haspopup="true"
           >
             Options
             <svg
               class="-mr-1 size-7 text-gray-400"
               viewBox="0 0 20 20"
               fill="currentColor"
               aria-hidden="true"
             >
               <path
                 fill-rule="evenodd"
                 d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                 clip-rule="evenodd"
               />
             </svg>
           </button>
         </div>
         <div
           id="menu"
           class="hidden absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"
           role="menu"
           aria-orientation="vertical"
           aria-labelledby="menu-button"
           tabindex="-1"
         >
           <div class="py-1" role="none">
             <a
               href="/logout"
               class="block px-4 py-2 text-sm text-gray-700"
               role="menuitem"
               tabindex="-1"
               id="menu-item-1"
               >Se Deconnecter</a
             >
           </div>
         </div>
       </div>
       <script>
         function toggleMenu() {
           const menu = document.getElementById("menu");
           menu.classList.toggle("hidden");
         }
 
         // Optionally, you can hide the menu when clicking outside of it
         document.addEventListener("click", function (event) {
           const menu = document.getElementById("menu");
           const button = document.getElementById("menu-button");
           if (!button.contains(event.target) && !menu.contains(event.target)) {
             menu.classList.add("hidden");
           }
         });
       </script>
 </header>
 <div class="isolate bg-white px-6 py-0 sm:py-0 lg:px-8 ">
  <div class="absolute inset-x-0 top-[-10rem] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[-20rem]" aria-hidden="true">
    <div class="relative left-1/2 -z-10 aspect-[1155/678] w-[36.125rem] max-w-none -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-blue-500 to-blue-500 opacity-30 sm:left-[calc(50%-40rem)] sm:w-[72.1875rem]" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
  </div>
  <form action="/user" method="POST" class="mx-auto mt-16 max-w-xl sm:mt-10" enctype="multipart/form-data">
    <div class="grid grid-cols-1 gap-x-8 gap-y-6 sm:grid-cols-2">
        <div class="sm:col-span-2">
            <label for="name" class="block text-sm font-semibold leading-6 text-gray-900">Nom Complet</label>
            <div class="mt-2.5">
                <input type="text" name="name" id="name" autocomplete="organization"
                       class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>
        </div>
        <div class="sm:col-span-2">
            <label for="matricule" class="block text-sm font-semibold leading-6 text-gray-900">Matricule</label>
            <div class="mt-2.5">
                <input type="text" name="matricule" id="matricule" autocomplete="organization"
                       class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>
        </div>
        <div class="sm:col-span-2">
          <label for="user_type" class="block text-sm font-semibold leading-6 text-gray-900">Type d'utilisateur</label>
          <div class="mt-2.5">
              <select name="user_type" id="user_type"
                      class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                  <option value="employe">Employé</option>
                  <option value="responsable">Responsable</option>
              </select>
          </div>
      </div>
    <div class="sm:col-span-2">
        <label for="service" class="block text-sm font-semibold leading-6 text-gray-900">Service</label>
        <div class="mt-2.5">
            <select id="service" name="service" onchange="updateBureauOptions()" required
                    class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                <option value="">Sélectionner</option>
                <option value="Service ingénierie des compétences et gestion de la formation">Service ingénierie des compétences et gestion de la formation</option>
                <option value="Service science d'écologie de biodiversité et d'érosion">Service science d'écologie de biodiversité et d'érosion</option>
                <option value="Service science d'amélioration génétiques des arbres forestiers et sylviculture">Service science d'amélioration génétiques des arbres forestiers et sylviculture</option>
                <option value="Service technologie du bois et des produits forestiers">Service technologie du bois et des produits forestiers</option>
            </select>
        </div>
    </div>
    <div class="sm:col-span-2">
        <label for="bureau" class="block text-sm font-semibold leading-6 text-gray-900">Numéro Bureau</label>
        <div class="mt-2.5">
          <select id="bureau" name="bureau" required
          class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            <option value=""></option>
  </select>
        </div>
    </div>
        <div class="sm:col-span-2">
            <label for="password" class="block text-sm font-semibold leading-6 text-gray-900">Mot de passe</label>
            <div class="mt-2.5">
                <input type="password" name="password" id="password" autocomplete="organization"
                       class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>
        </div>
        <div class="sm:col-span-2">
            <label for="confirm_password" class="block text-sm font-semibold leading-6 text-gray-900">Confirmation Mot de passe</label>
            <div class="mt-2.5">
                <input type="password" name="confirm_password" id="confirm_password"
                       class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>
        </div>
    </div>
    <div class="mt-10">
        <button type="submit"
                class="block w-full rounded-md bg-indigo-600 px-3.5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Inscription
        </button>
    </div>
</form>
</div>
<div class="container">
  {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
          <div class="alert-container">
              {% for category, message in messages %}
                  <div class="alert alert-{{ category }}">
                      {{ message }}
                  </div>
              {% endfor %}
              <button class="close-btn" onclick="closeAlert()">Ignorer</button>
          </div>
      {% endif %}
  {% endwith %}
  <!-- Votre code pour afficher le contenu de l'interface admin -->
</div>
</body>
</html>

<script>
  var notyf = new Notyf();

  $("form").submit(function (event) {
    event.preventDefault();
    var serializedData = $(this).serialize();
    request = $.ajax({
      url: $(this).attr("action"),
      type: $(this).attr("method"),
      data: serializedData,
      success: () => {
        notyf.success('Logged In');
        window.open('/check', '_current')
      },
      error: (e) => {
        notyf.error(e.responseJSON.error);
      },
    });
  });
</script>